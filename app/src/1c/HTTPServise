


////////////////////////////////////////////////////////////////////////////////
// МЕТОДЫ

//url test.get
//
Функция MethodTestGET(Запрос)
	Возврат ВернутьОтвет("test.get",Запрос);
КонецФункции

//url contractors.get
//
Функция MethodContractorsGET(Запрос)
	Возврат ВернутьОтвет("contractors.get",Запрос);;
КонецФункции


//url /* get
//
Функция MethodAnyGET(Запрос)
	Возврат ВернутьОтвет("any",Запрос);;
КонецФункции




////////////////////////////////////////////////////////////////////////////////
// ОБЩИЕ

Функция ВернутьДанные(ИмяМетода,Запрос,Ошибка,ОписаниеОшибки)
	Если ИмяМетода = "test.get" Тогда

		Возврат  АНИТ_API.TestGet(Запрос,Ошибка,ОписаниеОшибки);

	ИначеЕсли ИмяМетода = "contractors.get" Тогда

		Возврат  АНИТ_API.ContractorsGet(Запрос,Ошибка,ОписаниеОшибки);

	Иначе
		Ошибка = Истина;
		ОписаниеОшибки = "метод не найден!";

		Возврат Новый Структура;

	КонецЕсли;
КонецФункции


Функция ВернутьОтвет(ИмяМетода,Запрос)

	Ответ = Новый HTTPСервисОтвет(200);

	Структура = Новый Структура;
	Структура.Вставить("Пришел",ТекущаяДата());


	Ошибка = Ложь;
	ОписаниеОшибки = "";
	МетодОтвет =  Неопределено;

	Попытка
		МетодОтвет =  ВернутьДанные(ИмяМетода,Запрос,Ошибка,ОписаниеОшибки);
	Исключение
		МетодОтвет = Неопределено;
		Ошибка     = Истина;
		ОписаниеОшибки = ОписаниеОшибки();
	КонецПопытки;

	Структура.Вставить("Подготовлен",ТекущаяДата());
	Структура.Вставить("Ошибка",Ошибка);
    Структура.Вставить("ОписаниеОшибки",ОписаниеОшибки);

	Если Не Ошибка Тогда
		Структура.Вставить("Ответ",МетодОтвет);
	Иначе
		Структура.Вставить("Ответ",Неопределено);
	КонецЕсли;

	Ответ.УстановитьТелоИзСтроки(АНИТ_API.ВернутьСтрокуJSONИ(Структура));


	Возврат Ответ;
КонецФункции

Функция AnyURLGET(Запрос)
	Ответ = Новый HTTPСервисОтвет(200);
	Возврат Ответ;
КонецФункции



